const HtmlWebpackPlugin = require('html-webpack-plugin');

const data = appVersion => ({
  ts: new Date().toString(),
  version: appVersion,
  title: 'Dmitry Fisenko - Software Engineer',
  name: 'Dmitry Fisenko',
  position: 'Software Engineer',
  email: 'fisenkodv@gmail.com',
  description: 'Dmitry Fisenko',
  keywords: 'Dmitry Fisenko, developer, software, engineer, USA, NJ, .net, typescript, angular'
});

const minify = {
  html5: true,
  includeAutoGeneratedTags: true,
  minifyCSS: true,
  minifyJS: true,
  removeComments: true,
  collapseWhitespace: true,
  preserveLineBreaks: true,
  removeEmptyAttributes: true
};

module.exports = (isProd, appVersion) => {
  const templateData = data(isProd, appVersion);
  return [
    new HtmlWebpackPlugin({
      filename: 'index.html',
      inject: 'head',
      template: '!!ejs-compiled-loader!./src/index.ejs',
      data: templateData,
      minify: minify
    })
  ];
};
